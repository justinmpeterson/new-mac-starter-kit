#!/bin/bash

# Must run this command before this repo can even be cloned on a brand-new Mac:
# xcode-select --install

AWAIT=(read -p "Press any key to continue: " -n 1 -s)

cd ~

echo "01. Install Homebrew"
ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
"${AWAIT[@]}" && echo

echo "02. Update Homebrew and install Cask"
brew update
brew install cask
"${AWAIT[@]}" && echo

echo "03. Give Homebrew greater permissions"
sudo mkdir $(brew --prefix)/include
sudo mkdir $(brew --prefix)/Frameworks
sudo chown -R $(whoami) $(brew --prefix)/*
"${AWAIT[@]}" && echo

echo "04. Install many, many Homebrew applications"
brew install git git-flow hub
brew install reattach-to-user-namespace tmux
brew install bash coreutils jq miller moreutils p7zip telnet
brew install irssi python vim
"${AWAIT[@]}" && echo

echo "05. Install many, many Cask applications"
brew cask install docker
# brew cask install filezilla
brew cask install google-chrome
brew cask install iterm2
brew cask install minecraft
brew cask install pycharm-ce
brew cask install race-for-the-galaxy
brew cask install slack
brew cask install sourcetree
brew cask install spotify
brew cask install steam
brew cask install the-unarchiver
brew cask install visual-studio-code
"${AWAIT[@]}" && echo

echo "06. Create necessary directories"
mkdir ~/Desktop/Screenshots
mkdir ~/Documents/.logs
mkdir -p ~/Documents/code/documentation
mkdir ~/Documents/code/py
"${AWAIT[@]}" && echo

echo "07. Set up global Git config variables"
git config --global user.name "Justin Peterson"
git config --global user.email "justinmpeterson@gmail.com"
"${AWAIT[@]}" && echo

echo "08. Install vimwiki"
git clone https://github.com/vimwiki/vimwiki.git ~/.vim/pack/plugins/start/vimwiki
"${AWAIT[@]}" && echo

echo "09. Tell MacOS not to create .DS_Store files on network shares"
defaults write com.apple.desktopservices DSDontWriteNetworkStores true
"${AWAIT[@]}" && echo

echo "10. Save screenshots somewhere else"
defaults write com.apple.screencapture location ~/Desktop/Screenshots
"${AWAIT[@]}" && echo

echo "11. Symbolic links"
ln -s $HOME/Documents/code/new-mac-starter-kit/dotfiles/.bash_profile $HOME/.bash_profile
ln -s $HOME/Documents/code/new-mac-starter-kit/dotfiles/.tmux.conf $HOME/.tmux.conf
ln -s $HOME/Documents/code/new-mac-starter-kit/dotfiles/.vimrc $HOME/.vimrc
"${AWAIT[@]}" && echo

echo "12. Reset the Finder so my screenshot command takes effect immediately"
killall SystemUIServer
"${AWAIT[@]}" && echo

echo "13. Make Homebrew Bash my default shell"
echo "/usr/local/bin/bash" | sudo tee -a /etc/shells
chsh -s /usr/local/bin/bash
"${AWAIT[@]}" && echo

echo "Done!"
